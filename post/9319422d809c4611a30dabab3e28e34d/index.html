<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>时隔多年，再次捡起博客 - 嘀咕</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css"><link rel="stylesheet" href="/css/forever.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="wrap flex fd-c fai-c my-4 gap-4"><header class="flex fd-r fai-c fjc-sb mt-4 mb-8 gap-8"><div class="logo mb-1"><a class="flex px-2" href="/"><div class="draw"><div class="ghost"><div class="body"><div class="face"><div class="eyes"><span></span><span></span></div><div class="mouth"></div></div><div class="hands"> </div></div><div class="feet"><span></span><span></span><span></span><span></span></div></div></div><span class="name flex fjc-c fai-c">嘀咕</span></a></div><ul class="flex m-0 p-0 ta-c gap-6"><li><a href="/">首页</a></li><li><a href="/says">碎语</a></li><li><a href="/archives">归档</a></li><li><a href="/friends">朋友</a></li><li><a href="/about">关于</a></li></ul></header><main><article><div class="header flex fd-c fai-c"><h1 class="my-0">时隔多年，再次捡起博客</h1><time datetime="2022-05-14T11:05:00.000Z">2022-05-14 19:05</time></div><div class="content mt-6"><p>自从 2018 年有了小孩之后，基本上丢在一边，很少写博客。日志产量从日更到月更，从月更到年更，从年更到备份存档。刚弄博客才两三年的时候就一直有个信念，那就是不管以后是否继续写下去，但是博客一定保留下来、数据一定要备份好。毕竟这里面有自己傻逼的青春，令自己回忆的过往。</p>
<p>最近家里发生的大事，让我有了重新把博客捡起来继续记录的想法。不为别的，只是为了给自己多留下一些痕迹，也给日后想要了解我的人一个渠道。</p>
<p>早在 2019 年的时候，我就把博客所有的日志从 Typecho 转到了 Hexo，然后一直部署在 Github Pages。评论在多说之后也就再也没开放过，主要是找不到合适的评论服务，在本地尝试过 Valine、 Twikoo，因为无服务端的问题都选择放弃。这一次本来也是不打算折腾评论，只是发发日志就算了，但是又意外的了解到有服务端的 Waline，于是又开始折腾。</p>
<p>在折腾评论的时候，看到<a target="_blank" rel="noopener" href="https://imnerd.org/">@公子哥</a>发的<a target="_blank" rel="noopener" href="https://imnerd.org/hugo-ssr-comment.html">《静态博客如何高性能插入评论》</a>后，发现可以用Hexo的分页函数来生成出静态评论内容。</p>
<p>大致的方案如下：</p>
<ol>
<li>创建一个生成评论文件的 Docker 服务</li>
<li>使用 GitHub Actions 创建一个用来 pull、生成、commit、push 的动作集</li>
<li>通过 Waline 的<a target="_blank" rel="noopener" href="https://waline.js.org/reference/server.html#%E8%AF%84%E8%AE%BA-hooks">评论钩子</a>（如<code>postSave</code>、<code>postUpdate</code>、<code>postDelete</code>）来触发 Github Actions 动作集</li>
<li>触发 Vercel 自动构建部署</li>
</ol>
<p>实现以上的方案就可以做到静态博客拥有静态评论的体验，具体的实现方案之后抽空再写吧。当然，这种方式也会带来一些问题，主要就是评论没有那么快展示出来，提交后能看到的也只是一个临时的效果。不过目前测试，从提交（编辑、删除）到最终渲染出最新数据，最多也只是4分钟，对于我这种量级的评论来说足够了。</p>
<p>另外之后在和公子哥的讨论中，他建议可以直接使用 Waline 的<a target="_blank" rel="noopener" href="https://waline.js.org/guide/server/databases.html#github">Github数据存储</a>方式，这种方式的话就可以节省1-3的步骤，每次有评论的动作，就会触发 Vercel 进行自动构建，有兴趣的可以尝试一下。</p>
</div></article><div class="end flex fai-c fjc-c mb-4"><span class="flex fai-c fjc-c my-4 o2">THE-END</span></div><div class="tags my-4"><ul class="flex fjc-c fd-r gap-4"><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/%E5%8D%9A%E5%AE%A2/"><span>博客<sup>24</sup></span></a></li></ul></div><div class="near flex fjc-sb mb-4"><div class="prev"><a href="/post/8034746f42b3495fbb19926e3fb8ec4f/" ref="prev"><div class="text fw-b">PREVIOUS</div><div class="name">部署独立统计分析服务Umami</div></a></div><div class="next"><a href="/post/f6e896d9343049ccbda71fd04ca48957/" ref="next"><div class="text">NEXT</div><div class="name">木兰草原露营</div></a></div></div><div class="comments"><div class="comment-items"><h2 class="pl-2">评论列表</h2><div class="not-found flex fai-c fjc-c">「此时无声胜有声」</div></div></div></main><footer class="flex fjc-c"><div class="copyright"><p>© 2007 - 现在 <a href="">嘀咕</a></p></div></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script type="text/javascript" src="/js/forever.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-lazyload@1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script></div></body></html>