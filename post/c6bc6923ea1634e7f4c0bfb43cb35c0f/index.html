<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Typecho 小技巧两则 - 嘀咕</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css"><link rel="stylesheet" href="/css/forever.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="wrap flex fd-c fai-c my-4 gap-4"><header class="flex fd-r fai-c fjc-sb mt-4 mb-8 gap-8"><div class="logo mb-1"><a class="flex px-2" href="/"><div class="draw"><div class="ghost"><div class="body"><div class="face"><div class="eyes"><span></span><span></span></div><div class="mouth"></div></div><div class="hands"> </div></div><div class="feet"><span></span><span></span><span></span><span></span></div></div></div><span class="name flex fjc-c fai-c">嘀咕</span></a></div><ul class="flex m-0 p-0 ta-c gap-6"><li><a href="/">首页</a></li><li><a href="/says">碎语</a></li><li><a href="/archives">归档</a></li><li><a href="/friends">朋友</a></li><li><a href="/about">关于</a></li></ul></header><main><article><div class="header flex fd-c fai-c"><h1 class="my-0">Typecho 小技巧两则</h1><time datetime="2010-11-02T14:51:00.000Z">2010-11-02 22:51</time></div><div class="content mt-6"><p>又是一篇在 Typecho 下写的日志，哈哈。</p>
<p>这次呢，分享两个小技巧，都是正对程序侧栏的最新评论这个模块的技巧，分别是改变显示样式和忽略博主评论，下面开始分享。</p>
<h2 id="改变显示样式"><a href="#改变显示样式" class="headerlink" title="改变显示样式"></a>改变显示样式</h2><p>默认主题的显示样式很简单，“昵称：内容”，而我自己呢却不喜欢把内容直接显示出来，一个是因为评论太长了，二一个也许会把HTML代码给输出来。所以还是比较喜欢“昵称 在 《XXOO》 评论”，这样的话整齐美观，呵呵。代码如下：</p>
<div class="code-block mb-6"><div class="header px-4 py-3" data-language="php"><span></span><span></span><span></span></div><div class="body flex fd-r"><div class="line-numbers py-1 mx-3"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></div><pre class="language-php m-0 mr-4 py-1" data-language="php"><code class="language-php p-0"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>widget<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">_e</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'最新评论丨Recent Comments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">widget</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Widget_Comments_Recent'</span><span class="token punctuation">)</span><span class="token operator">-></span><span class="token function">to</span><span class="token punctuation">(</span><span class="token variable">$comments</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token variable">$comments</span><span class="token operator">-></span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span>
      <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$comments</span><span class="token operator">-></span><span class="token function">author</span><span class="token punctuation">(</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span> 在 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$comments</span><span class="token operator">-></span><span class="token function">excerpt</span><span class="token punctuation">(</span><span class="token number">26</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$comments</span><span class="token operator">-></span><span class="token function">permalink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token variable">$comments</span><span class="token operator">-></span><span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span> 评论
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span>
    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endwhile</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre></div></div>

<p>整体基本是默认的，改变的地方只有 li 标签中，下面看看这些函数的详细解释。</p>
<ul>
<li><code>&lt;?php $comments-&gt;author(true); ?&gt;</code>&#x2F;&#x2F;输出评论人昵称，参数true为带链接的，false为不带链接的；<br>&#x2F;&#x2F;ps.其实还有一个参数，类型也是布尔，作用是是否带noFollow</li>
<li><code>&lt;?php $comments-&gt;excerpt(26, &#39;...&#39;); ?&gt;</code>&#x2F;&#x2F;输出评论摘要，第一个参数是要截取的长度，第二个是截取后的字符串；</li>
<li><code>&lt;?php $comments-&gt;permalink(); ?&gt;</code>&#x2F;&#x2F;获取当前评论链接，木有参数；</li>
<li><code>&lt;?php $comments-&gt;title(); ?&gt;</code>&#x2F;&#x2F;获取当前评论标题，同样木有参数；</li>
<li><code>&lt;?php $comments-&gt;dateWord(); ?&gt;</code>&#x2F;&#x2F;输出词义化日期，就是输出“3小时前”、“三天前”之内的；</li>
<li><?php $comments->gravatar(); ?>&#x2F;&#x2F;调用gravatar输出用户头像，有两个参数，第一个是头像尺寸，默认是32，第二个是默认输出的头像。</li>
</ul>
<p>目前就只觉得这些有用，当然，这个类里面还有其他的方法，比如获得描点等，方法告诉大家了，剩下的样式设计就自己折腾吧。</p>
<h2 id="忽略博主评论"><a href="#忽略博主评论" class="headerlink" title="忽略博主评论"></a>忽略博主评论</h2><p>一开始折腾侧栏评论的时候就注意到了这个问题，我不回复别人的评论还好，一回复的话基本侧栏就是我在刷屏了，这样很不地道，完全是最新评论的垄断行为。所以嘛，就要把自己的评论给忽略掉，怎么做呢？网上找了半天找不到，后来在评论类中发现那个输出的方法其实是有一个参数是来控制是否忽略作者评论的，可是我在侧栏的页面中不会传参数进去，因为没见过这种写法。后来 <a target="_blank" rel="noopener" href="http://weburls.net/">@飞天舞</a> 童鞋给了我一个修改方法，但是是要修改源代码的，所以没有采纳。慢慢的折腾，参考其他的调用，看看有没有类似这种写法的，而且又能传参数的，不过还真让我找到了，是个关于tag的函数，写法和这个一样，所以，不用修改源代码的忽略方法诞生了。</p>
<p><code>&lt;?php $this-&gt;widget(&#39;Widget_Comments_Recent&#39;,&#39;ignoreAuthor=true&#39;)-&gt;to($comments); ?&gt;</code></p>
<p>侧栏文件中找到这段话，然后加上一个参数就OK了，默认的参数值是false，改为true，一切OK。</p>
</div></article><div class="end flex fai-c fjc-c mb-4"><span class="flex fai-c fjc-c my-4 o2">THE-END</span></div><div class="tags my-4"><ul class="flex fjc-c fd-r gap-4"><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/Typecho/"><span>Typecho<sup>12</sup></span></a></li><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/%E5%B0%8F%E6%8A%80%E5%B7%A7/"><span>小技巧<sup>1</sup></span></a></li></ul></div><div class="near flex fjc-sb mb-4"><div class="prev"><a href="/post/d5ee7797ba77119bc52c4378d3ab5737/" ref="prev"><div class="text fw-b">PREVIOUS</div><div class="name">现在的微博</div></a></div><div class="next"><a href="/post/b6248547bda1ecb0465d05a27363b417/" ref="next"><div class="text">NEXT</div><div class="name">Typecho 访客信息显示隐藏</div></a></div></div><div class="comments"><div class="comment-items"><h2 class="pl-2">评论列表</h2><div class="not-found flex fai-c fjc-c">「此时无声胜有声」</div></div></div></main><footer class="flex fjc-c"><div class="copyright"><p>© 2007 - 现在 <a href="">嘀咕</a></p></div></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script type="text/javascript" src="/js/forever.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-lazyload@1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script></div></body></html>