<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>Typecho，我又回来啦 - 嘀咕</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css"><link rel="stylesheet" href="/css/forever.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="wrap flex fd-c fai-c my-4 gap-4"><header class="flex fd-r fai-c fjc-sb mt-4 mb-8 gap-8"><div class="logo mb-1"><a class="flex px-2" href="/"><div class="draw"><div class="ghost"><div class="body"><div class="face"><div class="eyes"><span></span><span></span></div><div class="mouth"></div></div><div class="hands"> </div></div><div class="feet"><span></span><span></span><span></span><span></span></div></div></div><span class="name flex fjc-c fai-c">嘀咕</span></a></div><ul class="flex m-0 p-0 ta-c gap-6"><li><a href="/">首页</a></li><li><a href="/says">碎语</a></li><li><a href="/archives">归档</a></li><li><a href="/friends">朋友</a></li><li><a href="/about">关于</a></li></ul></header><main><article><div class="header flex fd-c fai-c"><h1 class="my-0">Typecho，我又回来啦</h1><time datetime="2022-08-23T16:15:00.000Z">2022-08-24 00:15</time></div><div class="content mt-6"><p>从2007年第一篇日志开始，博客到现在也有 15 年半了。空间从免费空间、虚拟主机等，到现在云服务器；域名从免费二级域名、CN 域名、NET 域名等，到现在个性化域名；博客系统从 PJBlog、BoBlog、WordPress、Typecho、Hexo，最后又回到了 Typecho。</p>
<h2 id="低成本维持"><a href="#低成本维持" class="headerlink" title="低成本维持"></a>低成本维持</h2><p>2016 年，有小孩之后，几乎一年就那么一两篇日志，妥妥地年更博客。2018 年左右，在衡天小张购买的虚拟主机也要到期了，因为是老客户，有个特惠价，但是一买就是三年。犹豫再三后，还是决定续费，毕竟博客我还是需要留着，更不更新再说吧。又到了 2019 年，域名又要续费，一个域名也是几十块钱。这个时候我就在犹豫，是不是要把博客转到静态博客，部署到 Github 白嫖空间，再换一个便宜点的个性域名。这样可以让博客低成本的活着，也能满足我年更或者不更的需求。说干就干，把 Typecho 的数据转换成 Hexo，再买了个新域名，最后再把当前的虚拟主机<a target="_blank" rel="noopener" href="http://forum.typecho.org/viewtopic.php?p=44012">转卖</a>给别人，大功告成。</p>
<h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>在用 Typecho 的期间，一直用多说作为评论系统，多说关闭后，没有找到比多说靠谱的评论系统，所以评论也就一直关闭着。最近因为一些事情，想<a href="/post/9319422d809c4611a30dabab3e28e34d/">重新让博客活跃</a>起来，除了更新频率外，博友之间的交流也是少不了的，评论的事情自然就提上了日程。</p>
<p>现在的评论系统比起多说同期多了很多选择，各方面了解后选择了<a target="_blank" rel="noopener" href="https://imnerd.org/">@公子哥</a>的<a target="_blank" rel="noopener" href="https://waline.js.org/">Waline</a>。选择它原因有以下几点：一是有服务端，安全方面可控；二是可玩性强，多种数据源、较多的钩子便于二次开发；三是和公子哥老熟人，遇到问题可以<del>骚扰</del>请教他。</p>
<p>平静了一段时间，看到<a target="_blank" rel="noopener" href="https://eallion.com/">@蜗牛</a>的『<a target="_blank" rel="noopener" href="https://eallion.com/disqus/">再说评论</a>』，让我觉得有同感，Waline 还是太重了，不符合自己的需求，于是开始对 Waline 进行深度折腾。前端组件就两个主要功能，一是请求访客评论，二是渲染评论列表。自己弄个评论框请求服务端接口，访客评论搞定，然后利用 Waline 的评论钩子，对站点进行重新构建。这样做优点就是整站包括评论都是静态化，浏览器解析速度更佳，缺点的话主要是新评论会有三到四分钟的延迟呈现，如果同时或者短时间内容出现多条评论，会有几率构建失败。这两个缺点虽然不能全部根除，但是可以进一步优化，于是打算给 Waline 贡献代码。但是，我前端水平菜得抠脚，开发环境都是在公子哥的帮助下才勉强跑起来，思路更是实现艰难，复杂的项目结构让我无从下手，多次尝试后选择放弃。</p>
<p>评论不就是请求、响应、渲染三个步骤吗？思考一阵后决定，用熟悉的 Java 写个简单的评论系统用来代替现在的 Waline 服务端，说干就干。语言熟悉，思路清晰，很快就有了初版成果，很高兴的打算部署使用。但是问题又来了，我这个 Java 程序要部署在哪里？我没运行环境啊？买一个？但是买了我为什么不直接用动态博客？不买？不买我部署在哪里啊？买一个？…..</p>
<h2 id="回归"><a href="#回归" class="headerlink" title="回归"></a>回归</h2><p>Typecho 1.2 也发布了，于是乎又开始折腾回 Typecho。</p>
<h3 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h3><p>将日志和评论转入到 Typecho，没有找到现成的工具，一切都要撸起袖子自己干，读文件插数据库，特殊语法特殊对待。</p>
<p>转换评论的过程中意外的发现之前是有很大一部分评论没有完全转换到 Hexo 的，不知道之前是在哪个环节转换评论的时候导致丢失了，丢失的都是我回复别人的评论，还好意外找回。</p>
<h3 id="主题"><a href="#主题" class="headerlink" title="主题"></a>主题</h3><p>个人比较偏向于简洁的主题，主页日志留个标题，详情进去看。找来找去看上了@蚂蚱给<a target="_blank" rel="noopener" href="https://springnotes.cn/">@暮春</a>写的主题，于是索要过来改造。结合其他博客看到的设计，东拼西凑的成了现在的样子。</p>
<h3 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h3><p>因为 1.2 对 PHP 环境最低支持是 7.2 版本，很多以前的插件受到不同程度的影响，多年未接触 Typecho 也让我与它脱节，不知道有什么插件可以代替。自己动手，丰衣足食，定制的才是最符合自己的，于是捣鼓出下面几个插件：</p>
<ul>
<li>Comment2U：评论通知，支持 Email、企业微信；</li>
<li>DiguKit：自用的大杂烩工具箱，方便换主题后功能复用；</li>
<li>DiguLinks：友情链接插件；</li>
<li>DiguSay：嘀咕碎语，支持多种消息类型的微博客插件。</li>
</ul>
<p>DiguLinks 其实有功能基本一样的插件，是<a target="_blank" rel="noopener" href="http://www.imhan.com/">@HANNY</a>大神的<a target="_blank" rel="noopener" href="https://github.com/typecho-fans/plugins/tree/master/Links">Links</a>，不过年久失修，虽然有社区维护版，但是总感觉怪怪的，于是就造了个轮子。</p>
<p>DiguSay 是因为偶尔还是有那么一两句话想说，但是又不能形成文章的场景。其实早在之前用 Typecho 的时候就写过一个叫做 Digu 的插件，主要功能也就是这个，这一次算是完全重构。可以从微信发送文字、图片、位置、语音，基本上满足日常需求。</p>
<p>邮件通知以前用的是 CommentToMail，是@Byends基于@DEFE的维护版本，但是现在在1.2中完全水土不服。Comment2U 主要功能就是邮件通知访客有人回复了他们的评论，微信通知博主有新的评论。</p>
<p>DiguKit 就纯粹是为了以后换主题方便集成，不用做重复的事情。</p>
<p>也许以后所使用的博客系统还会变，但不变的是，博客会一直存在下去。</p>
</div></article><div class="end flex fai-c fjc-c mb-4"><span class="flex fai-c fjc-c my-4 o2">THE-END</span></div><div class="tags my-4"><ul class="flex fjc-c fd-r gap-4"><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/%E5%8D%9A%E5%AE%A2/"><span>博客<sup>24</sup></span></a></li><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/Typecho/"><span>Typecho<sup>12</sup></span></a></li></ul></div><div class="near flex fjc-sb mb-4"><div class="prev"><a href="/post/9cd5a8cf9e6b4a14a7385a521009591f/" ref="prev"><div class="text fw-b">PREVIOUS</div><div class="name">家长比学生还累</div></a></div><div class="next"><a href="/post/fd8c12c76bbe4fc29a299691fb361862/" ref="next"><div class="text">NEXT</div><div class="name">最近做的几个梦</div></a></div></div><div class="comments"><div class="comment-items"><h2 class="pl-2">评论列表</h2><div class="not-found flex fai-c fjc-c">「此时无声胜有声」</div></div></div></main><footer class="flex fjc-c"><div class="copyright"><p>© 2007 - 现在 <a href="">嘀咕</a></p></div></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script type="text/javascript" src="/js/forever.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-lazyload@1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script></div></body></html>