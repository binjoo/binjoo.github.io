<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><meta name="theme-color" content="#202020"><meta http-equiv="x-ua-compatible" content="ie=edge"><title>碎语 - 基于Typecho的微博客插件 - 嘀咕</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.7.0/style.min.css"><link rel="stylesheet" href="/css/forever.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css"><meta name="generator" content="Hexo 7.1.1"></head><body><div class="wrap flex fd-c fai-c my-4 gap-4"><header class="flex fd-r fai-c fjc-sb mt-4 mb-8 gap-8"><div class="logo mb-1"><a class="flex px-2" href="/"><div class="draw"><div class="ghost"><div class="body"><div class="face"><div class="eyes"><span></span><span></span></div><div class="mouth"></div></div><div class="hands"> </div></div><div class="feet"><span></span><span></span><span></span><span></span></div></div></div><span class="name flex fjc-c fai-c">嘀咕</span></a></div><ul class="flex m-0 p-0 ta-c gap-6"><li><a href="/">首页</a></li><li><a href="/says">碎语</a></li><li><a href="/archives">归档</a></li><li><a href="/friends">朋友</a></li><li><a href="/about">关于</a></li></ul></header><main><article><div class="header flex fd-c fai-c"><h1 class="my-0">碎语 - 基于Typecho的微博客插件</h1><time datetime="2023-02-20T13:26:00.000Z">2023-02-20 21:26</time></div><div class="content mt-6"><p>微博客是轻量化的博客，一句话的博客。饭否、嘀咕、腾讯微博、Twitter 都用过，唯独没用过新浪微博，当时就觉得它娱乐性太重了，不喜欢。微信朋友圈，圈子又不太对，很多事情都不方便发出。博客的内容又太长，自己太懒，一个月保证一篇就足够了，所以微博客最适合我。于是，自己动手，丰衣足食，折腾了一个基于 Typecho 的微博客插件<strong>碎语</strong>，效果请查看<a href="/says">我的碎语页面</a>。</p>
<p>基本功能都已经完成，可以基于微信&amp;企业微信发送文本、图片、位置、语音消息，后台还可以根据<a href="#%E6%B6%88%E6%81%AF%E5%90%88%E5%B9%B6%E8%A7%84%E5%88%99">消息合并规则</a>对消息进行合并，合并后可以形成图文、图集以及语音、位置的描述消息。</p>
<p>总的来说，自己够用，暂时不会有太大更新，有兴趣的自行折腾吧。</p>
<h2 id="后台示图"><a href="#后台示图" class="headerlink" title="后台示图"></a>后台示图</h2><ul class="gallery gallery-2 gap-1"><li><a class="image" target="_blank" rel="noopener" href="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/4828040a11674c828d18effacf78c79b.png!style:original" data-fancybox="gallery" data-caption="撰写碎语"><img class="lazy br-1" data-original="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/4828040a11674c828d18effacf78c79b.png!style:definition" src="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/4828040a11674c828d18effacf78c79b.png!style:thumbnail" alt="撰写碎语"></a></li><li><a class="image" target="_blank" rel="noopener" href="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/5ba9848af9dc4f96b4fe0f64aea4580b.png!style:original" data-fancybox="gallery" data-caption="碎语管理"><img class="lazy br-1" data-original="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/5ba9848af9dc4f96b4fe0f64aea4580b.png!style:definition" src="https://digu-image-host.s3.bitiful.net/2023/02/569bf36b2740419e9e71cec3c00e489d/5ba9848af9dc4f96b4fe0f64aea4580b.png!style:thumbnail" alt="碎语管理"></a></li></ul>

<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>说是准备工作，其实很多东西可有可无，如果全部都有，则是完全体，用起来体验也是最佳的。</p>
<ul>
<li>【必须】又拍云：用于存储图片、语音附件；<a target="_blank" rel="noopener" href="https://console.upyun.com/register/?invite=NgDOtWKWX">申请地址</a></li>
<li>TinyPNG：用于有损压缩图片，基本不损失画质和感官；<a target="_blank" rel="noopener" href="https://tinify.cn/developers">申请地址</a></li>
<li>高德地图：用于支持地理位置分享；<a target="_blank" rel="noopener" href="https://lbs.amap.com/">申请地址</a></li>
<li>【推荐】企业微信：用于支持多种消息类型的发布渠道，自行创建企业和应用；<a target="_blank" rel="noopener" href="https://work.weixin.qq.com/wework_admin/loginpage_wx">申请地址</a></li>
</ul>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ul>
<li>因为使用的是contents表存储数据，所以日志ID连续强迫症者请勿使用；</li>
<li>PHP环境需要支持<code>pcntl_fork</code>函数，不支持的话会出现图片多次发送的情况；</li>
<li>附件（图片、语音）仅支持又拍云存储，不支持本地存储；</li>
<li>使用语音消息会产生一定费用，如果每天发10条语音，每条语音一分钟，一个月的费用大概是1.14元，具体请查看<a target="_blank" rel="noopener" href="https://www.upyun.com/products/process#section-pricing">又拍云云处理价格</a></li>
</ul>
<h2 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h2><p>内含 Typecho插件、Chrome 插件和主题模板示例，其中主题模板示例大家可以参考模板的使用，在当前使用的主题下创建<code>say.php</code>文件，插件则会自动匹配主题文件。</p>
<p><a target="_blank" rel="noopener" href="https://wwin.lanzoue.com/b0dt2i7wh">蓝奏云</a> - 密码：4e3z</p>
<h2 id="消息渠道"><a href="#消息渠道" class="headerlink" title="消息渠道"></a>消息渠道</h2><table>
<thead>
<tr>
<th>渠道</th>
<th>文本</th>
<th>图文</th>
<th>图片</th>
<th>图集</th>
<th>语音</th>
<th>视频</th>
<th>链接</th>
</tr>
</thead>
<tbody><tr>
<td>后台</td>
<td>✔️</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>微信&amp;企业微信</td>
<td>✔️</td>
<td>❕</td>
<td>✔️</td>
<td>❕</td>
<td>✔️</td>
<td>❌</td>
<td>✔️</td>
</tr>
</tbody></table>
<p>✔️：支持、❌：不支持、❕：可合并</p>
<h2 id="消息合并规则"><a href="#消息合并规则" class="headerlink" title="消息合并规则"></a>消息合并规则</h2><p>多条同类型或不同类型的消息合并到时间最早的一条消息。</p>
<ul>
<li>允许一条 text 与一条及以上 image 合并，类型改为 textpic；</li>
<li>允许一条 textpic 与一条及以上 image 合并，类型改为 textpic；</li>
<li>允许一条 text 与一条 location 合并，类型改为 location；</li>
<li>允许一条 text 与一条 voice 合并，类型改为 voice；</li>
<li>允许一条 text 与一条 music 合并，类型改为 music；</li>
<li>允许多条 image 合并，类型为 image；</li>
</ul>
<h2 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h2><ul>
<li><input checked="" disabled="" type="checkbox"> 消息标签</li>
<li><input disabled="" type="checkbox"> 消息评论</li>
<li><input disabled="" type="checkbox"> 消息独立页面</li>
</ul>
<h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><h3 id="v1-1-0"><a href="#v1-1-0" class="headerlink" title="v1.1.0"></a>v1.1.0</h3><ul>
<li>代码重构，使用原生数据表<code>contents</code>，不单独创建数据表；</li>
<li>支持消息带有标签；</li>
<li>增加支持网易云音乐链接；</li>
<li>支持 Chrome 插件；</li>
</ul>
<h3 id="v1-0-0"><a href="#v1-0-0" class="headerlink" title="v1.0.0"></a>v1.0.0</h3><ul>
<li>支持多种消息类型：文本消息<strong>text</strong>、图片消息<strong>image</strong>、图文消息<strong>textpic</strong>、语音消息<strong>voice</strong>、位置消息<strong>location</strong>；</li>
<li>支持三种消息状态（公开、私密、隐藏）；</li>
<li>支持管理后台发送文本消息；</li>
<li>支持企业微信发送文本消息、图片消息、语音消息、位置消息；</li>
<li>支持后台合并消息（具体查看<a href="#%E6%B6%88%E6%81%AF%E5%90%88%E5%B9%B6%E8%A7%84%E5%88%99">消息合并规则</a>）</li>
<li>支持又拍云存储图片、语音资源；</li>
<li>支持 TinyPNG 压缩图片后进行存储；</li>
</ul>
</div></article><div class="end flex fai-c fjc-c mb-4"><span class="flex fai-c fjc-c my-4 o2">THE-END</span></div><div class="tags my-4"><ul class="flex fjc-c fd-r gap-4"><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/%E6%8F%92%E4%BB%B6/"><span>插件<sup>13</sup></span></a></li><li><a class="py-1 px-4 flex fd-c fai-c" href="/tags/Typecho/"><span>Typecho<sup>12</sup></span></a></li></ul></div><div class="near flex fjc-sb mb-4"><div class="prev"><a href="/post/9bc1a34929eb4b6ea058c08d76b8d76f/" ref="prev"><div class="text fw-b">PREVIOUS</div><div class="name">小柠柠是演技派</div></a></div><div class="next"><a href="/post/a8d6cf7ba81a4de5b7186d2dac62a6c0/" ref="next"><div class="text">NEXT</div><div class="name">分享仿微信PC邮件通知模板</div></a></div></div><div class="comments"><div class="comment-items"><h2 class="pl-2">评论列表</h2><div class="not-found flex fai-c fjc-c">「此时无声胜有声」</div></div></div></main><footer class="flex fjc-c"><div class="copyright"><p>© 2007 - 现在 <a href="">嘀咕</a></p></div></footer><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script><script type="text/javascript" src="/js/forever.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery-lazyload@1.9.7/jquery.lazyload.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script></div></body></html>